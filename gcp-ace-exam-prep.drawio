<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:147.0) Gecko/20100101 Firefox/147.0" version="29.4.0" pages="3">
  <diagram id="AHIeRDgFPxS0jaqBbyzj" name="4.2 Cloud Build">
    <mxGraphModel dx="1055" dy="608" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-1" parent="1" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" value="" vertex="1">
          <mxGeometry height="710" width="800" x="10" y="10" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-2" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="103" width="800" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-3" parent="rIEmjimXDaofbVHIQ_TJ-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;rowspan=1;colspan=3;" value="5.1 Kubernetes cluster and deployment" vertex="1">
          <mxGeometry height="103" width="800" as="geometry">
            <mxRectangle height="103" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-4" parent="rIEmjimXDaofbVHIQ_TJ-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1" visible="0">
          <mxGeometry height="103" width="263" x="270" as="geometry">
            <mxRectangle height="103" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-5" parent="rIEmjimXDaofbVHIQ_TJ-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1" visible="0">
          <mxGeometry height="103" width="267" x="533" as="geometry">
            <mxRectangle height="103" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-10" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="57" width="800" y="103" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-11" parent="rIEmjimXDaofbVHIQ_TJ-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="enable Cloud Build API" vertex="1">
          <mxGeometry height="57" width="270" as="geometry">
            <mxRectangle height="57" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-12" parent="rIEmjimXDaofbVHIQ_TJ-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="&lt;font face=&quot;Courier New&quot;&gt;gcloud services enable cloudbuild.googleapis.com&lt;/font&gt;" vertex="1">
          <mxGeometry height="57" width="263" x="270" as="geometry">
            <mxRectangle height="57" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-13" parent="rIEmjimXDaofbVHIQ_TJ-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="57" width="267" x="533" as="geometry">
            <mxRectangle height="57" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-14" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="110" width="800" y="160" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-15" parent="rIEmjimXDaofbVHIQ_TJ-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a simple Dockerfile" vertex="1">
          <mxGeometry height="110" width="270" as="geometry">
            <mxRectangle height="110" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-16" parent="rIEmjimXDaofbVHIQ_TJ-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="#!/bin/sh&lt;br&gt;echo &quot;Hello, world! The time is $(date).&quot;&lt;br&gt;&lt;br&gt;FROM alpine&lt;br&gt;COPY quickstart.sh /&lt;br&gt;CMD [&quot;/quickstart.sh&quot;]" vertex="1">
          <mxGeometry height="110" width="263" x="270" as="geometry">
            <mxRectangle height="110" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-17" parent="rIEmjimXDaofbVHIQ_TJ-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="110" width="267" x="533" as="geometry">
            <mxRectangle height="110" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-18" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="110" width="800" y="270" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-19" parent="rIEmjimXDaofbVHIQ_TJ-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Change permissions on the quickstart (make it executable)" vertex="1">
          <mxGeometry height="110" width="270" as="geometry">
            <mxRectangle height="110" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-20" parent="rIEmjimXDaofbVHIQ_TJ-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="chmod +x quickstart.sh" vertex="1">
          <mxGeometry height="110" width="263" x="270" as="geometry">
            <mxRectangle height="110" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-21" parent="rIEmjimXDaofbVHIQ_TJ-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="110" width="267" x="533" as="geometry">
            <mxRectangle height="110" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-22" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="110" width="800" y="380" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-23" parent="rIEmjimXDaofbVHIQ_TJ-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a Docker Artifact Repository" vertex="1">
          <mxGeometry height="110" width="270" as="geometry">
            <mxRectangle height="110" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-24" parent="rIEmjimXDaofbVHIQ_TJ-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud artifacts repositories&amp;nbsp;create&amp;nbsp;quickstart-docker-repo --repository-format docker --description &quot;Docker Repo&quot;" vertex="1">
          <mxGeometry height="110" width="263" x="270" as="geometry">
            <mxRectangle height="110" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-25" parent="rIEmjimXDaofbVHIQ_TJ-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="110" width="267" x="533" as="geometry">
            <mxRectangle height="110" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-26" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="110" width="800" y="490" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-27" parent="rIEmjimXDaofbVHIQ_TJ-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Get the Registry URI for the repository&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;" vertex="1">
          <mxGeometry height="110" width="270" as="geometry">
            <mxRectangle height="110" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-28" parent="rIEmjimXDaofbVHIQ_TJ-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="REGISTRY_URI=$(gcloud artifacts repositories describe quickstart-docker-repo --format &quot;value(registryUri)&quot;)" vertex="1">
          <mxGeometry height="110" width="263" x="270" as="geometry">
            <mxRectangle height="110" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-29" parent="rIEmjimXDaofbVHIQ_TJ-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="110" width="267" x="533" as="geometry">
            <mxRectangle height="110" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-30" parent="rIEmjimXDaofbVHIQ_TJ-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="110" width="800" y="600" as="geometry" />
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-31" parent="rIEmjimXDaofbVHIQ_TJ-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Submit to Cloud Build to create an image" vertex="1">
          <mxGeometry height="110" width="270" as="geometry">
            <mxRectangle height="110" width="270" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-32" parent="rIEmjimXDaofbVHIQ_TJ-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud builds submit --tag ${REGISTRY_URI}/quickstart-image:tag1" vertex="1">
          <mxGeometry height="110" width="263" x="270" as="geometry">
            <mxRectangle height="110" width="263" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rIEmjimXDaofbVHIQ_TJ-33" parent="rIEmjimXDaofbVHIQ_TJ-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="110" width="267" x="533" as="geometry">
            <mxRectangle height="110" width="267" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="5.1" id="fJa-bGf0KtOeBzwlbln7">
    <mxGraphModel dx="1758" dy="1013" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="41zspn_ZCD3zTolKA1WF-1" parent="1" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" value="" vertex="1">
          <mxGeometry height="1820" width="960" x="40" y="30" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-2" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="40" width="960" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-3" parent="41zspn_ZCD3zTolKA1WF-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;rowspan=1;colspan=3;fontStyle=1" value="Implementing least privilege policy bindings in Cloud Run" vertex="1">
          <mxGeometry height="40" width="960" as="geometry">
            <mxRectangle height="40" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-4" parent="41zspn_ZCD3zTolKA1WF-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1" visible="0">
          <mxGeometry height="40" width="470" x="230" as="geometry">
            <mxRectangle height="40" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-26" parent="41zspn_ZCD3zTolKA1WF-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1" visible="0">
          <mxGeometry height="40" width="260" x="700" as="geometry">
            <mxRectangle height="40" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-5" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="40" width="960" y="40" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-6" parent="41zspn_ZCD3zTolKA1WF-5" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Enable Cloud run service" vertex="1">
          <mxGeometry height="40" width="230" as="geometry">
            <mxRectangle height="40" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-7" parent="41zspn_ZCD3zTolKA1WF-5" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud services enable run.googleapis.com" vertex="1">
          <mxGeometry height="40" width="470" x="230" as="geometry">
            <mxRectangle height="40" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-27" parent="41zspn_ZCD3zTolKA1WF-5" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="40" width="260" x="700" as="geometry">
            <mxRectangle height="40" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-8" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="40" width="960" y="80" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-9" parent="41zspn_ZCD3zTolKA1WF-8" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a location environment variable" vertex="1">
          <mxGeometry height="40" width="230" as="geometry">
            <mxRectangle height="40" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-10" parent="41zspn_ZCD3zTolKA1WF-8" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="export LOCATION=us-central1" vertex="1">
          <mxGeometry height="40" width="470" x="230" as="geometry">
            <mxRectangle height="40" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-28" parent="41zspn_ZCD3zTolKA1WF-8" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="40" width="260" x="700" as="geometry">
            <mxRectangle height="40" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-11" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="40" width="960" y="120" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-12" parent="41zspn_ZCD3zTolKA1WF-11" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Set the default cloud run region" vertex="1">
          <mxGeometry height="40" width="230" as="geometry">
            <mxRectangle height="40" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-13" parent="41zspn_ZCD3zTolKA1WF-11" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud config set run/region $LOCATION" vertex="1">
          <mxGeometry height="40" width="470" x="230" as="geometry">
            <mxRectangle height="40" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-29" parent="41zspn_ZCD3zTolKA1WF-11" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="40" width="260" x="700" as="geometry">
            <mxRectangle height="40" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-14" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="70" width="960" y="160" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-15" parent="41zspn_ZCD3zTolKA1WF-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Deploy billing application image to Cloud Run&lt;br&gt;&lt;b&gt;any user on the internet should be able to access it&lt;/b&gt;" vertex="1">
          <mxGeometry height="70" width="230" as="geometry">
            <mxRectangle height="70" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-16" parent="41zspn_ZCD3zTolKA1WF-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud run deploy billing-service --image &amp;lt;image-path&amp;gt;" vertex="1">
          <mxGeometry height="70" width="470" x="230" as="geometry">
            <mxRectangle height="70" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-30" parent="41zspn_ZCD3zTolKA1WF-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcr.io/qwiklabs-resources/gsp723-parking-service" vertex="1">
          <mxGeometry height="70" width="260" x="700" as="geometry">
            <mxRectangle height="70" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-17" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="70" width="960" y="230" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-18" parent="41zspn_ZCD3zTolKA1WF-17" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Once deployed, set the value of the service URL on BILLING_SERVICE_URL environment variable" vertex="1">
          <mxGeometry height="70" width="230" as="geometry">
            <mxRectangle height="70" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-19" parent="41zspn_ZCD3zTolKA1WF-17" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="BILLING_SERVICE_URL=$(gcloud run services billing-service --filter &quot;value(URL)&quot;)" vertex="1">
          <mxGeometry height="70" width="470" x="230" as="geometry">
            <mxRectangle height="70" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-31" parent="41zspn_ZCD3zTolKA1WF-17" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="70" width="260" x="700" as="geometry">
            <mxRectangle height="70" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-32" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="300" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-33" parent="41zspn_ZCD3zTolKA1WF-32" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Run a POST curl on the URL" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-34" parent="41zspn_ZCD3zTolKA1WF-32" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="&lt;pre class=&quot;bash wrap hljs&quot;&gt;curl -X POST -H &lt;span class=&quot;hljs-string&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt; \&lt;br&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$BILLING_SERVICE_URL&lt;/span&gt; \&lt;br&gt;-d &lt;span class=&quot;hljs-string&quot;&gt;&#39;{&quot;userid&quot;: &quot;1234&quot;, &quot;minBalance&quot;: 100}&#39;&lt;/span&gt;&lt;/pre&gt;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-35" parent="41zspn_ZCD3zTolKA1WF-32" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="&lt;pre class=&quot;bash wrap hljs&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&#39;{&quot;userid&quot;: &quot;1234&quot;, &quot;minBalance&quot;: 100}&#39;&lt;/span&gt;&lt;/pre&gt;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-36" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="380" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-37" parent="41zspn_ZCD3zTolKA1WF-36" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Review the call made in the logs on GC Console and notice minBalance entry" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-38" parent="41zspn_ZCD3zTolKA1WF-36" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="NA" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-39" parent="41zspn_ZCD3zTolKA1WF-36" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-40" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="460" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-41" parent="41zspn_ZCD3zTolKA1WF-40" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="View the iam policy on the service&amp;nbsp;" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-42" parent="41zspn_ZCD3zTolKA1WF-40" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="gcloud run services billing-service get-iam-policy" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-43" parent="41zspn_ZCD3zTolKA1WF-40" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-44" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="540" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-45" parent="41zspn_ZCD3zTolKA1WF-44" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Remove policy binding from the service" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-46" parent="41zspn_ZCD3zTolKA1WF-44" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="gcloud run services billing-service remove-iam-policy-binding --members allUsers --role roles/run.invoker" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-47" parent="41zspn_ZCD3zTolKA1WF-44" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="Now, the call fails.&amp;nbsp; So, we&#39;ll create a service account with roles/run.invoker and assign use it in our cloud shell and then try to call the service again" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-48" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="620" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-49" parent="41zspn_ZCD3zTolKA1WF-48" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a service account" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-50" parent="41zspn_ZCD3zTolKA1WF-48" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="gcloud iam services-accounts create billing-initiator --display-name &quot;Billing Initiator&quot;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-51" parent="41zspn_ZCD3zTolKA1WF-48" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-52" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="700" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-53" parent="41zspn_ZCD3zTolKA1WF-52" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Grant roles/run.invoker permission on console" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-54" parent="41zspn_ZCD3zTolKA1WF-52" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-55" parent="41zspn_ZCD3zTolKA1WF-52" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-56" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="780" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-57" parent="41zspn_ZCD3zTolKA1WF-56" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Set the billing-initiator SA email on env variable&amp;nbsp;" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-58" parent="41zspn_ZCD3zTolKA1WF-56" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="BILLING_INITIATOR_EMAIL=$(gcloud iam service-accounts list --filter billing-initiator --format &quot;value(EMAIL)&quot;)&amp;nbsp; &amp;amp;&amp;amp; echo&amp;nbsp;$BILLING_INITIATOR_EMAIL" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-59" parent="41zspn_ZCD3zTolKA1WF-56" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-60" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="860" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-61" parent="41zspn_ZCD3zTolKA1WF-60" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a key file for the service account" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-62" parent="41zspn_ZCD3zTolKA1WF-60" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="&lt;pre class=&quot;bash wrap hljs&quot;&gt;gcloud iam service-accounts keys create key.json \&lt;br&gt;--iam-account=&lt;span class=&quot;hljs-variable&quot;&gt;${BILLING_INITIATOR_EMAIL}&lt;/span&gt;&lt;/pre&gt;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-63" parent="41zspn_ZCD3zTolKA1WF-60" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-64" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="940" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-65" parent="41zspn_ZCD3zTolKA1WF-64" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="&lt;b&gt;In a new Cloud Shell Tab&lt;/b&gt;&lt;br&gt;Activate the service account in the shell" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-66" parent="41zspn_ZCD3zTolKA1WF-64" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="&lt;pre class=&quot;bash wrap hljs&quot;&gt;gcloud auth activate-service-account \&lt;br&gt;--key-file=key.json&lt;/pre&gt;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-67" parent="41zspn_ZCD3zTolKA1WF-64" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="After a minute or two, again try to call the service and it should be successful" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-72" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1020" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-73" parent="41zspn_ZCD3zTolKA1WF-72" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Invoke the service" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-74" parent="41zspn_ZCD3zTolKA1WF-72" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;" value="&amp;nbsp;curl -X POST -H &quot;Content-Type: application/json&quot; \&lt;br&gt;&amp;nbsp; -H &quot;Authorization: Bearer $(gcloud auth print-identity-token)&quot; \&lt;br&gt;&amp;nbsp; $BILLING_SERVICE_URL -d &#39;{&quot;userid&quot;: &quot;1234&quot;, &quot;minBalance&quot;: 500}&#39;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-75" parent="41zspn_ZCD3zTolKA1WF-72" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=#6c8ebf;overflow=hidden;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="This works because the service account is activated on this shell" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-76" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1100" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-77" parent="41zspn_ZCD3zTolKA1WF-76" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=none;" value="Deploy a second service (using the same image)" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-78" parent="41zspn_ZCD3zTolKA1WF-76" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=none;" value="gcloud run deploy billing-service-2 --image nginxinc/nginx-unprivileged --platform managed --no-allow-unathenticated" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-79" parent="41zspn_ZCD3zTolKA1WF-76" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=none;" value="nginxinc/nginx-unprivileged" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-80" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1180" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-81" parent="41zspn_ZCD3zTolKA1WF-80" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Assign the URL of the new service to an environment variable" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-82" parent="41zspn_ZCD3zTolKA1WF-80" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="BILLING_SERVICE_2_URL=$(gcloud run services list --filter billing-service-2 --format &quot;value(URL)&quot;)" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-83" parent="41zspn_ZCD3zTolKA1WF-80" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-92" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-93" parent="41zspn_ZCD3zTolKA1WF-92" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="In a 3rd cloud shell, activate the service account we created" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-94" parent="41zspn_ZCD3zTolKA1WF-92" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" value="&lt;div&gt;gcloud auth activate-service-account \&lt;/div&gt;&lt;div&gt;--key-file key.json&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-95" parent="41zspn_ZCD3zTolKA1WF-92" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-84" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1340" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-85" parent="41zspn_ZCD3zTolKA1WF-84" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="Make a GET call to the billing-service-2" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-86" parent="41zspn_ZCD3zTolKA1WF-84" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" value="curl -H &quot;Authorization: Bearer $(gcloud auth print-identity-token)&quot; http://${BILLING_SERVICE_2_URL}" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-87" parent="41zspn_ZCD3zTolKA1WF-84" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=#fff2cc;strokeColor=#d6b656;" value="We can see that this too works so our SA doesn&#39;t have least privileged." vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-88" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1420" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-89" parent="41zspn_ZCD3zTolKA1WF-88" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=none;strokeColor=#6c8ebf;" value="Set the billing-initiator-email on an environment variable as we are going to remove project level roles/run.invoker on it" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-90" parent="41zspn_ZCD3zTolKA1WF-88" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=none;strokeColor=#6c8ebf;" value="&lt;pre class=&quot;bash wrap hljs&quot;&gt; BILLING_INITIATOR_EMAIL=$(gcloud iam service-accounts list \&lt;br&gt;--filter=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Billing Initiator&quot;&lt;/span&gt; \&lt;br&gt;--format=&lt;span class=&quot;hljs-string&quot;&gt;&quot;value(EMAIL)&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-built_in&quot;&gt;\&lt;br&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$BILLING_INITIATOR_EMAIL&lt;/span&gt;&lt;/pre&gt;" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-91" parent="41zspn_ZCD3zTolKA1WF-88" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=none;strokeColor=#6c8ebf;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-96" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1500" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-97" parent="41zspn_ZCD3zTolKA1WF-96" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=none;strokeColor=#6c8ebf;" value="Remove project level permissions on the service account" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-98" parent="41zspn_ZCD3zTolKA1WF-96" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=none;strokeColor=#6c8ebf;" value="gcloud projects remove-iam-policy-binding $GOOGLE_CLOUD_PROJECT \&lt;br&gt;&amp;nbsp; --member=serviceAccount:${BILLING_INITIATOR_EMAIL} \&lt;br&gt;&amp;nbsp; --role=roles/run.invoker" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-99" parent="41zspn_ZCD3zTolKA1WF-96" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=none;strokeColor=#6c8ebf;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-100" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1580" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-101" parent="41zspn_ZCD3zTolKA1WF-100" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=none;strokeColor=#6c8ebf;" value="Add permission at the resource level for billing-service" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-102" parent="41zspn_ZCD3zTolKA1WF-100" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=none;strokeColor=#6c8ebf;" value="gcloud run services add-iam-policy-binding billing-service --region $LOCATION \&lt;br&gt;&amp;nbsp; --member=serviceAccount:${BILLING_INITIATOR_EMAIL} \&lt;br&gt;&amp;nbsp; --role=roles/run.invoker --platform managed" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-103" parent="41zspn_ZCD3zTolKA1WF-100" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=none;strokeColor=#6c8ebf;" vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-104" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1660" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-105" parent="41zspn_ZCD3zTolKA1WF-104" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="Call the service again in the 2nd terminal" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-106" parent="41zspn_ZCD3zTolKA1WF-104" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="curl -H &quot;Authorization:$(gcloud auth print-identity-token)&quot; $BILLING_SERVICE_URL" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-107" parent="41zspn_ZCD3zTolKA1WF-104" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="This should be successful as the SA associated with it has the roles/run.invoker on it." vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-108" parent="41zspn_ZCD3zTolKA1WF-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="80" width="960" y="1740" as="geometry" />
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-109" parent="41zspn_ZCD3zTolKA1WF-108" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="Call the service in the 3rd terminal" vertex="1">
          <mxGeometry height="80" width="230" as="geometry">
            <mxRectangle height="80" width="230" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-110" parent="41zspn_ZCD3zTolKA1WF-108" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;align=center;fillColor=#fff2cc;strokeColor=#d6b656;" value="curl -H &quot;Authorization:$(gcloud auth print-identity-token)&quot; $BILLING_SERVICE_2_URL" vertex="1">
          <mxGeometry height="80" width="470" x="230" as="geometry">
            <mxRectangle height="80" width="470" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="41zspn_ZCD3zTolKA1WF-111" parent="41zspn_ZCD3zTolKA1WF-108" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;overflow=hidden;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;fillColor=#fff2cc;strokeColor=#d6b656;" value="This should fail because SA associated with this resource dosn&#39;t have the roles/run.invoker on it." vertex="1">
          <mxGeometry height="80" width="260" x="700" as="geometry">
            <mxRectangle height="80" width="260" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="s02oRiUNjDFN6BGDiG4U" name=" 5.2">
    <mxGraphModel dx="1055" dy="608" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-1" parent="1" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" value="" vertex="1">
          <mxGeometry height="900" width="790" x="20" y="20" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-2" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="40" width="790" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-3" parent="nWwl-SGgjiBtsJC7h2Ws-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="40" width="213" as="geometry">
            <mxRectangle height="40" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-4" parent="nWwl-SGgjiBtsJC7h2Ws-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="40" width="344" x="213" as="geometry">
            <mxRectangle height="40" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-5" parent="nWwl-SGgjiBtsJC7h2Ws-2" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="40" width="233" x="557" as="geometry">
            <mxRectangle height="40" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-6" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="91" width="790" y="40" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-7" parent="nWwl-SGgjiBtsJC7h2Ws-6" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="enable the services" vertex="1">
          <mxGeometry height="91" width="213" as="geometry">
            <mxRectangle height="91" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-8" parent="nWwl-SGgjiBtsJC7h2Ws-6" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;align=center;" value="&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;gcloud services enable run.googleapis.com;\&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;gcloud services enable pubsub.googleapis.com&lt;/font&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="91" width="344" x="213" as="geometry">
            <mxRectangle height="91" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-9" parent="nWwl-SGgjiBtsJC7h2Ws-6" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="91" width="233" x="557" as="geometry">
            <mxRectangle height="91" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-10" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" value="" vertex="1">
          <mxGeometry height="112" width="790" y="131" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-11" parent="nWwl-SGgjiBtsJC7h2Ws-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="set the configuration" vertex="1">
          <mxGeometry height="112" width="213" as="geometry">
            <mxRectangle height="112" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-12" parent="nWwl-SGgjiBtsJC7h2Ws-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="&lt;div&gt;&amp;nbsp;LOCATION=us-central1;\&lt;/div&gt;&lt;div&gt;gcloud config set compute/region $LOCATION&lt;/div&gt;" vertex="1">
          <mxGeometry height="112" width="344" x="213" as="geometry">
            <mxRectangle height="112" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-13" parent="nWwl-SGgjiBtsJC7h2Ws-10" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="" vertex="1">
          <mxGeometry height="112" width="233" x="557" as="geometry">
            <mxRectangle height="112" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-14" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="111" width="790" y="243" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-15" parent="nWwl-SGgjiBtsJC7h2Ws-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Deploy the store-service" vertex="1">
          <mxGeometry height="111" width="213" as="geometry">
            <mxRectangle height="111" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-16" parent="nWwl-SGgjiBtsJC7h2Ws-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="&amp;nbsp;gcloud run deploy store-service \&lt;br&gt;&amp;nbsp; --image gcr.io/qwiklabs-resources/gsp724-store-service \&lt;br&gt;&amp;nbsp; --allow-unauthenticated" vertex="1">
          <mxGeometry height="111" width="344" x="213" as="geometry">
            <mxRectangle height="111" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-17" parent="nWwl-SGgjiBtsJC7h2Ws-14" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="111" width="233" x="557" as="geometry">
            <mxRectangle height="111" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-18" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="111" width="790" y="354" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-19" parent="nWwl-SGgjiBtsJC7h2Ws-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Deploy the consumer service" vertex="1">
          <mxGeometry height="111" width="213" as="geometry">
            <mxRectangle height="111" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-20" parent="nWwl-SGgjiBtsJC7h2Ws-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="&amp;nbsp;gcloud run deploy order-service \&lt;br&gt;&amp;nbsp; --image gcr.io/qwiklabs-resources/gsp724-order-service \&lt;br&gt;&lt;b&gt;&amp;nbsp; --no-allow-unauthenticated&lt;/b&gt;" vertex="1">
          <mxGeometry height="111" width="344" x="213" as="geometry">
            <mxRectangle height="111" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-21" parent="nWwl-SGgjiBtsJC7h2Ws-18" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="111" width="233" x="557" as="geometry">
            <mxRectangle height="111" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-22" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="111" width="790" y="465" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-23" parent="nWwl-SGgjiBtsJC7h2Ws-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a pubsub topic" vertex="1">
          <mxGeometry height="111" width="213" as="geometry">
            <mxRectangle height="111" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-24" parent="nWwl-SGgjiBtsJC7h2Ws-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud pubsub topics create ORDER_PLACED" vertex="1">
          <mxGeometry height="111" width="344" x="213" as="geometry">
            <mxRectangle height="111" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-25" parent="nWwl-SGgjiBtsJC7h2Ws-22" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="111" width="233" x="557" as="geometry">
            <mxRectangle height="111" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-26" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="81" width="790" y="576" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-27" parent="nWwl-SGgjiBtsJC7h2Ws-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Create a service account" vertex="1">
          <mxGeometry height="81" width="213" as="geometry">
            <mxRectangle height="81" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-28" parent="nWwl-SGgjiBtsJC7h2Ws-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud iam service-accounts create pubsub-cloud-run-invoker --display-name &quot;Order Initiator&quot;" vertex="1">
          <mxGeometry height="81" width="344" x="213" as="geometry">
            <mxRectangle height="81" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-29" parent="nWwl-SGgjiBtsJC7h2Ws-26" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="81" width="233" x="557" as="geometry">
            <mxRectangle height="81" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-30" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="81" width="790" y="657" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-31" parent="nWwl-SGgjiBtsJC7h2Ws-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Confirm the SA was created" vertex="1">
          <mxGeometry height="81" width="213" as="geometry">
            <mxRectangle height="81" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-32" parent="nWwl-SGgjiBtsJC7h2Ws-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="&amp;nbsp;gcloud iam service-accounts list --filter=&quot;Order Initiator&quot;" vertex="1">
          <mxGeometry height="81" width="344" x="213" as="geometry">
            <mxRectangle height="81" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-33" parent="nWwl-SGgjiBtsJC7h2Ws-30" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="81" width="233" x="557" as="geometry">
            <mxRectangle height="81" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-34" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="81" width="790" y="738" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-35" parent="nWwl-SGgjiBtsJC7h2Ws-34" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Add&amp;nbsp; binding to order-service iam policy giving roles/run.invoker permission to the newly created service account" vertex="1">
          <mxGeometry height="81" width="213" as="geometry">
            <mxRectangle height="81" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-36" parent="nWwl-SGgjiBtsJC7h2Ws-34" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="gcloud run services add-iam-policy-binding order-service --member $(gcloud iam service-accounts list --filter &quot;Order Initiator&quot; --format &quot;value(EMAIL)&quot;) --role roles/run.invoker --platform managed" vertex="1">
          <mxGeometry height="81" width="344" x="213" as="geometry">
            <mxRectangle height="81" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-37" parent="nWwl-SGgjiBtsJC7h2Ws-34" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="81" width="233" x="557" as="geometry">
            <mxRectangle height="81" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-38" parent="nWwl-SGgjiBtsJC7h2Ws-1" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1">
          <mxGeometry height="81" width="790" y="819" as="geometry" />
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-39" parent="nWwl-SGgjiBtsJC7h2Ws-38" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" value="Add PROJECT_NUMBER to an environment variable" vertex="1">
          <mxGeometry height="81" width="213" as="geometry">
            <mxRectangle height="81" width="213" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-40" parent="nWwl-SGgjiBtsJC7h2Ws-38" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontFamily=Courier New;" value="PROJECT_NUMBER=$(gcloud projects list --format &quot;value(PROJECT_NUMBER)&quot; --filter &quot;project-id&quot;)&amp;nbsp;" vertex="1">
          <mxGeometry height="81" width="344" x="213" as="geometry">
            <mxRectangle height="81" width="344" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nWwl-SGgjiBtsJC7h2Ws-41" parent="nWwl-SGgjiBtsJC7h2Ws-38" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" vertex="1">
          <mxGeometry height="81" width="233" x="557" as="geometry">
            <mxRectangle height="81" width="233" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
